<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.82.0"><meta name=description content="Tutorial website for FXGL"><meta name=author content="Mazela-Man"><link rel=icon href=/mazela-man/assets/favicon.ico type=image/ico><title>01. Handling input - Mazela-Man FXGL Tutorial</title><link href=/mazela-man/css/nucleus.css?1617117229 rel=stylesheet><link href=/mazela-man/css/fontawesome-all.min.css?1617117229 rel=stylesheet><link href=/mazela-man/css/hybrid.css?1617117229 rel=stylesheet><link href=/mazela-man/css/featherlight.min.css?1617117229 rel=stylesheet><link href=/mazela-man/css/perfect-scrollbar.min.css?1617117229 rel=stylesheet><link href=/mazela-man/css/auto-complete.css?1617117229 rel=stylesheet><link href=/mazela-man/css/atom-one-dark-reasonable.css?1617117229 rel=stylesheet><link href=/mazela-man/css/theme.css?1617117229 rel=stylesheet><link href=/mazela-man/css/hugo-theme.css?1617117229 rel=stylesheet><link href=/mazela-man/css/theme-red.css?1617117229 rel=stylesheet><script src=/mazela-man/js/jquery-3.3.1.min.js?1617117229></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=/mazela-man/01_handling_input/><nav id=sidebar><div id=header-wrapper><div id=header><a id=logo href=/><img src=https://dykstrom.github.io/mazela-man/images/07/cherries-live.png></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=/mazela-man/js/lunr.min.js?1617117229></script><script type=text/javascript src=/mazela-man/js/auto-complete.js?1617117229></script><script type=text/javascript>var baseurl="https://dykstrom.github.io/mazela-man/"</script><script type=text/javascript src=/mazela-man/js/search.js?1617117229></script></div><div class=highlightable><ul class=topics><li data-nav-id=/mazela-man/home/ title=Mazela-Man class=dd-item><a href=/mazela-man/home/>Mazela-Man</a></li><li data-nav-id=/mazela-man/introduction/ title=Introduction class=dd-item><a href=/mazela-man/introduction/>Introduction</a></li><li data-nav-id=/mazela-man/01_handling_input/ title="01. Handling input" class="dd-item
parent
active"><a href=/mazela-man/01_handling_input/>01. Handling input</a></li><li data-nav-id=/mazela-man/02_physics/ title="02. Physics" class=dd-item><a href=/mazela-man/02_physics/>02. Physics</a></li><li data-nav-id=/mazela-man/03_eating_and_keeping_score/ title="03. Eating and Keeping Score" class=dd-item><a href=/mazela-man/03_eating_and_keeping_score/>03. Eating and Keeping Score</a></li><li data-nav-id=/mazela-man/04_animation/ title="04. Animation" class=dd-item><a href=/mazela-man/04_animation/>04. Animation</a></li><li data-nav-id=/mazela-man/05_adding_enemies/ title="05. Adding Enemies" class=dd-item><a href=/mazela-man/05_adding_enemies/>05. Adding Enemies</a></li><li data-nav-id=/mazela-man/06_second_level/ title="06. A Second Level" class=dd-item><a href=/mazela-man/06_second_level/>06. A Second Level</a></li><li data-nav-id=/mazela-man/07_bonus_points/ title="07. Bonus Points" class=dd-item><a href=/mazela-man/07_bonus_points/>07. Bonus Points</a></li><li data-nav-id=/mazela-man/08_adding_sounds/ title="08. Adding Sound" class=dd-item><a href=/mazela-man/08_adding_sounds/>08. Adding Sound</a></li><li data-nav-id=/mazela-man/09_enable_main_menu/ title="09. Enable Main Menu" class=dd-item><a href=/mazela-man/09_enable_main_menu/>09. Enable Main Menu</a></li><li data-nav-id=/mazela-man/10_end_of_tutorial/ title="10. End of Tutorial" class=dd-item><a href=/mazela-man/10_end_of_tutorial/>10. End of Tutorial</a></li></ul><section id=footer><p>Built with <a href=https://github.com/matcornic/hugo-theme-learn><i class="fas fa-heart"></i></a> from <a href=https://getgrav.org>Grav</a> and <a href=https://gohugo.io/>Hugo</a></p></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span>
<span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links><a href=/mazela-man/>Home</a> > 01. Handling input</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><ul><li><a href=#getting-the-player-entity>Getting the Player Entity</a></li><li><a href=#registering-user-actions>Registering User Actions</a></li></ul></li><li><a href=#game-menu>Game Menu</a></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>01. Handling input</h1><p>Now we have set the scene for our game. The next step is to make it interactive. We want the
player character to move when we press a key. FXGL has bindings for both keyboard and mouse
input, but in this tutorial we will only use keyboard input.</p><h3 id=getting-the-player-entity>Getting the Player Entity</h3><p>To move the player entity, we first must retrieve it from the game world somehow. To do this
we need to define an enum that serves as the entity type. Do not confuse the entity type with
the type string used in Tiled to make FXGL spawn an entity. The enum <code>EntityType</code> is used when
finding entities in a live game world. Let&rsquo;s create a new file with the enum <code>EntityType</code> in it.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>enum</span> EntityType <span style=color:#f92672>{</span>
    PLAYER
<span style=color:#f92672>}</span>
</code></pre></div><p>Now we can modify the <code>spawnPlayer</code> method to set this type on the entity being created. We call
the builder method <code>type</code>.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java>    <span style=color:#a6e22e>@Spawns</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Player&#34;</span><span style=color:#f92672>)</span>
    <span style=color:#66d9ef>public</span> Entity <span style=color:#a6e22e>spawnPlayer</span><span style=color:#f92672>(</span>SpawnData data<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
        <span style=color:#66d9ef>return</span> FXGL<span style=color:#f92672>.</span><span style=color:#a6e22e>entityBuilder</span><span style=color:#f92672>(</span>data<span style=color:#f92672>)</span>
            <span style=color:#f92672>.</span><span style=color:#a6e22e>type</span><span style=color:#f92672>(</span>EntityType<span style=color:#f92672>.</span><span style=color:#a6e22e>PLAYER</span><span style=color:#f92672>)</span>
            <span style=color:#f92672>.</span><span style=color:#a6e22e>viewWithBBox</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;player.png&#34;</span><span style=color:#f92672>)</span>
            <span style=color:#f92672>.</span><span style=color:#a6e22e>build</span><span style=color:#f92672>();</span>
        <span style=color:#f92672>}</span>
</code></pre></div><p>The spawned player will now have the entity type <code>PLAYER</code>, and FXGL lets us find entities by
type. We add a convenience method to <code>MazelaManApp</code> to get the player entity.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> Entity <span style=color:#a6e22e>getPlayer</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
        <span style=color:#66d9ef>return</span> FXGL<span style=color:#f92672>.</span><span style=color:#a6e22e>getGameWorld</span><span style=color:#f92672>().</span><span style=color:#a6e22e>getSingleton</span><span style=color:#f92672>(</span>EntityType<span style=color:#f92672>.</span><span style=color:#a6e22e>PLAYER</span><span style=color:#f92672>);</span>
    <span style=color:#f92672>}</span>
</code></pre></div><h3 id=registering-user-actions>Registering User Actions</h3><p>When we have a way to get the player entity, so it can be updated, we need to tell FXGL that
we are interested in certain key presses by registering user actions for those keys. The FXGL
<code>GameApplication</code> base class has a callback method we can override to do that. It is called
<code>initInput</code>. In this method we can call one or more methods on the FXGL facade to register the
user actions, like this:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java>    <span style=color:#a6e22e>@Override</span>
    <span style=color:#66d9ef>protected</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>initInput</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
        FXGL<span style=color:#f92672>.</span><span style=color:#a6e22e>onKey</span><span style=color:#f92672>(</span>KeyCode<span style=color:#f92672>.</span><span style=color:#a6e22e>A</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;Move Left&#34;</span><span style=color:#f92672>,</span> <span style=color:#f92672>()</span> <span style=color:#f92672>-&gt;</span> getPlayer<span style=color:#f92672>().</span><span style=color:#a6e22e>translateX</span><span style=color:#f92672>(-</span>SPEED<span style=color:#f92672>));</span>
        <span style=color:#f92672>...</span>
    <span style=color:#f92672>}</span>
</code></pre></div><p>The code above registers a user action that runs when the <code>A</code> key is pressed. The name of the
action is &ldquo;Move Left&rdquo;. This name actually has a meaning, as we will see soon. When the action
runs, we get the player entity and move it some amount to the left. For this to work, we
obviously need to define the constant <code>SPEED</code> as well.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>int</span> SPEED <span style=color:#f92672>=</span> 2<span style=color:#f92672>;</span>
</code></pre></div><p>The methods <code>translateX</code> and <code>translateY</code> move the entity relative to its current location. There
are also methods <code>setX</code> and <code>setY</code> that move the entity to an absolute location. Note that there
is no physics involved here. There are no forces that affect the entity. It only moves when
we tell it to move.</p><p>There are other ways to register user actions. If you want more fine-grained control of how
to react to button presses, you can instead register a <code>UserAction</code> instance, and override the
methods you need.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java>        FXGL<span style=color:#f92672>.</span><span style=color:#a6e22e>getInput</span><span style=color:#f92672>().</span><span style=color:#a6e22e>addAction</span><span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> UserAction<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Move Left&#34;</span><span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
            <span style=color:#a6e22e>@Override</span>
            <span style=color:#66d9ef>protected</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>onAction</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span> <span style=color:#f92672>}</span>

            <span style=color:#a6e22e>@Override</span>
            <span style=color:#66d9ef>protected</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>onActionBegin</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span> <span style=color:#f92672>}</span>

            <span style=color:#a6e22e>@Override</span>
            <span style=color:#66d9ef>protected</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>onActionEnd</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span> <span style=color:#f92672>}</span>
        <span style=color:#f92672>},</span> KeyCode<span style=color:#f92672>.</span><span style=color:#a6e22e>A</span><span style=color:#f92672>);</span>
</code></pre></div><p>To finish up, here is the complete <code>initInput</code> method.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java>    <span style=color:#a6e22e>@Override</span>
    <span style=color:#66d9ef>protected</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>initInput</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
        FXGL<span style=color:#f92672>.</span><span style=color:#a6e22e>onKey</span><span style=color:#f92672>(</span>KeyCode<span style=color:#f92672>.</span><span style=color:#a6e22e>A</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;Move Left&#34;</span><span style=color:#f92672>,</span> <span style=color:#f92672>()</span> <span style=color:#f92672>-&gt;</span> getPlayer<span style=color:#f92672>().</span><span style=color:#a6e22e>translateX</span><span style=color:#f92672>(-</span>SPEED<span style=color:#f92672>));</span>
        FXGL<span style=color:#f92672>.</span><span style=color:#a6e22e>onKey</span><span style=color:#f92672>(</span>KeyCode<span style=color:#f92672>.</span><span style=color:#a6e22e>D</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;Move Right&#34;</span><span style=color:#f92672>,</span> <span style=color:#f92672>()</span> <span style=color:#f92672>-&gt;</span> getPlayer<span style=color:#f92672>().</span><span style=color:#a6e22e>translateX</span><span style=color:#f92672>(</span>SPEED<span style=color:#f92672>));</span>
        FXGL<span style=color:#f92672>.</span><span style=color:#a6e22e>onKey</span><span style=color:#f92672>(</span>KeyCode<span style=color:#f92672>.</span><span style=color:#a6e22e>W</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;Move Up&#34;</span><span style=color:#f92672>,</span> <span style=color:#f92672>()</span> <span style=color:#f92672>-&gt;</span> getPlayer<span style=color:#f92672>().</span><span style=color:#a6e22e>translateY</span><span style=color:#f92672>(-</span>SPEED<span style=color:#f92672>));</span>
        FXGL<span style=color:#f92672>.</span><span style=color:#a6e22e>onKey</span><span style=color:#f92672>(</span>KeyCode<span style=color:#f92672>.</span><span style=color:#a6e22e>S</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;Move Down&#34;</span><span style=color:#f92672>,</span> <span style=color:#f92672>()</span> <span style=color:#f92672>-&gt;</span> getPlayer<span style=color:#f92672>().</span><span style=color:#a6e22e>translateY</span><span style=color:#f92672>(</span>SPEED<span style=color:#f92672>));</span>
    <span style=color:#f92672>}</span>
</code></pre></div><h2 id=game-menu>Game Menu</h2><p>I mentioned before that the name of the action has a meaning, and now we will see how. FXGL
has a built-in game menu that we get for free in all games. It contains sub menus for setting
properties that most games need, including key bindings. So we get for free, the ability to
let the user choose their own key bindings. If you want, you can also add a main menu that
is displayed when the game is started.</p><p>The game menu is accessed by pressing the Esc key while the game is running. Try this, and
then click Options and then Controls. This will display the sub menu for choosing key bindings
and here you will see the action names we entered before.</p><p><img src=https://dykstrom.github.io/mazela-man/images/01/key-bindings.png alt="Key Bindings"></p><p>If you try the game as it is now, you soon find a major problem. The player can move through
walls! In fact, it can even move off-screen. To solve this problem we will add physics and
collisions in the <a href=https://dykstrom.github.io/mazela-man/manual/02_physics/>next chapter</a>.</p><p><img src=https://dykstrom.github.io/mazela-man/images/01/outside-wall.png alt="Outside the Wall"></p><footer class=footline></footer></div></div><div id=navigation><a class="nav nav-prev" href=/mazela-man/introduction/ title=Introduction><i class="fa fa-chevron-left"></i></a>
<a class="nav nav-next" href=/mazela-man/02_physics/ title="02. Physics" style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/mazela-man/js/clipboard.min.js?1617117229></script><script src=/mazela-man/js/perfect-scrollbar.min.js?1617117229></script><script src=/mazela-man/js/perfect-scrollbar.jquery.min.js?1617117229></script><script src=/mazela-man/js/jquery.sticky.js?1617117229></script><script src=/mazela-man/js/featherlight.min.js?1617117229></script><script src=/mazela-man/js/highlight.pack.js?1617117229></script><script>hljs.initHighlightingOnLoad()</script><script src=/mazela-man/js/modernizr.custom-3.6.0.js?1617117229></script><script src=/mazela-man/js/learn.js?1617117229></script><script src=/mazela-man/js/hugo-learn.js?1617117229></script><script src=/mazela-man/mermaid/mermaid.js?1617117229></script><script>mermaid.initialize({startOnLoad:!0})</script></body></html>